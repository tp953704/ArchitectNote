# Vertex AI 生成式 AI：提示設計實驗室筆記

## 概述
本實驗室專注於提示工程（Prompt Engineering），學習設計有效提示的最佳實踐，以提高 LLM 生成回應的質量。

## Gemini 模型介紹

### Gemini Pro
- 專為複雜推理設計
- 分析和總結大量資訊
- 跨模態推理（文字、程式碼、圖像等）
- 解決複雜程式碼庫問題

### Gemini Flash
- 優化速度和效率
- 亞秒級響應時間和高吞吐量
- 低成本高質量
- 增強的多模態能力

## 提示工程最佳實踐

### 1. 簡潔明確 (Be Concise)
- 避免冗長和模糊的提示
- 直接表達需求
- 減少不必要的詞彙

### 2. 具體且定義清晰 (Be Specific and Well-defined)
- 提供明確的上下文
- 定義清晰的邊界和約束
- 避免開放式問題導致不確定性

### 3. 一次一個任務 (Ask One Task at a Time)
- 避免在單一提示中要求多個不相關任務
- 複雜任務應分解為多個步驟
- 確保模型專注於單一目標

### 4. 警惕幻覺 (Watch out for Hallucinations)
- 模型可能生成看似合理但不正確的資訊
- 需要驗證關鍵事實
- 提供參考資料可減少幻覺

## 減少輸出變異性的技巧

### 系統指令 (System Instructions)
- 為模型設定角色和邊界
- 明確定義回應範圍
- 防止偏離主題的回應

**範例：旅行聊天機器人系統指令**
```
你是一個旅行助手，專門回答與航班、住宿和景點相關的問題。
請不要回答與旅行無關的問題。
```

### 將生成任務轉為分類任務
- 生成任務：輸出變異性高，可能產生意外結果
- 分類任務：輸出受限於預定義選項，變異性低

**生成任務範例：**
```
描述這個產品的情感傾向
```
可能產生各種不同的描述方式

**分類任務範例：**
```
將這個產品評論分類為：正面、負面或中性
```
輸出限制在三種明確選項中

## 透過範例提高回應質量

### 少量樣本學習 (Few-shot Learning)
- 提供 1-5 個代表性範例
- 模型從上下文中學習回應模式
- 範例質量和分佈很重要

### 最佳實踐
- 選擇具有代表性的範例
- 保持範例分佈與實際使用情況一致
- 避免過多範例導致過度擬合

**範例：情感分析**
```
範例1：
評論：這部電影太精彩了！
情感：正面

範例2：
評論：服務很糟糕。
情感：負面

現在分析這個評論：產品質量一般。
```

## 技術設置要點

### 環境要求
- Python 程式基礎
- Jupyter Notebook 環境
- Google Gen AI SDK

### 常見問題處理
- 429 錯誤（速率限制）：等待 1 分鐘後重試
- 使用臨時實驗帳戶，避免個人帳戶產生費用

## 關鍵學習成果

1. **提示設計原則**：簡潔、具體、單一任務
2. **輸出控制**：使用系統指令和分類任務減少變異性
3. **質量提升**：透過範例引導模型學習
4. **安全考慮**：減少幻覺和不相關回應

## 延伸學習資源

- [Gemini 官方文檔](https://cloud.google.com/vertex-ai/generative-ai/docs)
- [Vertex AI Cookbook](https://github.com/GoogleCloudPlatform/vertex-ai-samples)
- [生成式 AI YouTube 頻道](https://www.youtube.com/@GoogleCloudTech)

這個實驗室提供了實用的提示工程基礎，對於有效使用生成式 AI 模型至關重要。

# Vertex AI Studio 入門實驗室筆記

## 概述
Vertex AI Studio 是一個快速原型設計工具，讓使用者無需編程即可測試和自定義生成式 AI 模型，特別適合保險業等場景的應用開發。

## 主要學習目標

### 1. 從提示創建應用程式
**流程步驟：**
- 在 Vertex AI Studio 中創建新的聊天提示
- 設定系統指令定義 AI 角色
- 設計具體的提示內容
- 一鍵部署為 Cloud Run 應用

**保險風險分析範例：**
```
系統指令：
你是保險核保部門的專家 AI 助手，主要目標是幫助核保人員準確簡要地總結客戶資訊並突出潛在風險因素。

提示：
客戶資訊：[具體客戶資料]
任務：
1. 簡要總結業務關鍵細節和安全措施
2. 基於提供資訊識別核保人員應考慮的潛在風險因素
```

### 2. 設計有效的提示

#### 零樣本提示 (Zero-shot Prompting)
- 不提供範例，直接要求模型執行任務
- 適合簡單、明確的任務

#### 少樣本提示 (Few-shot Prompting)
- 提供 1-2 個輸入-輸出範例
- 顯著提高模型性能和格式一致性
- 特別適合數據提取和格式化任務

**保險索賠數據提取範例：**
```
輸入：索賠通知文字
輸出：
保單號碼：XXX
索賠人姓名：XXX
損失日期：XXX
...
```

### 3. 模型參數調校

#### Temperature（溫度）
- **低值 (0.0-0.2)**：專注、確定性輸出，適合事實性任務
- **高值 (1.5-2.0)**：創意、多樣化輸出，適合創意寫作

#### Top-P（核採樣）
- 控制輸出的隨機性
- 較低值使輸出更集中

#### 輸出令牌限制
- 控制回應長度
- 防止過長或截斷的回應

### 4. 提示比較與管理

#### 比較功能使用
- 並排比較不同提示版本
- 測試不同系統指令的效果
- 評估不同模型參數的影響

#### 模型選擇比較
- **Gemini Flash**：快速回應，適合簡單任務
- **Gemini Pro**：更精確的推理，適合複雜分析

### 5. 多模態提示

#### 圖像分析能力
- 上傳圖像並進行分析
- 提取圖像中的文字資訊
- 基於圖像內容進行推理

**航班時刻表分析範例：**
```
1. 為圖像提供簡潔標題
2. 描述圖像內容
3. 提取所有可見文字並格式化為列表
4. 基於時刻表進行百分比計算
```

### 6. 媒體生成

#### Imagen 圖像生成
- 從文字描述生成圖像
- 支援修補 (Inpaint) 和擴展 (Outpaint)
- SynthID 數字水印技術

#### Chirp 語音生成
- 文字轉語音功能
- 多種語言和聲音選擇
- 高質量語音輸出

## 關鍵技術特性

### 系統指令 (System Instructions)
- 在處理使用者提示前設定的全域指令
- 定義 AI 的角色、邊界和行為準則
- 跨多個對話輪次有效

### 進階功能
- **思考預算**：控制模型推理深度
- **結構化輸出**：強制模型遵循預定義格式
- **基礎檢索**：連接 Google 搜索或自定義數據源

## 最佳實踐總結

### 提示設計原則
1. **明確角色定義**：在系統指令中清晰定義 AI 角色
2. **具體任務描述**：避免模糊不清的指示
3. **提供範例**：使用少樣本提示提高準確性
4. **適當參數設置**：根據任務類型調整溫度和其他參數

### 部署考量
- 原型可快速部署為公開 Web 應用
- 生產環境需要配置適當的安全設置
- Cloud Run 提供無伺服器部署解決方案

## 實際應用場景

### 保險業用例
- 風險分析助手
- 索賠數據提取
- 文件分析和總結
- 客戶服務自動化

這個實驗室展示了 Vertex AI Studio 在快速原型設計方面的強大能力，讓使用者在無需深入機器學習知識的情況下，就能創建和部署生成式 AI 解決方案。



# Vertex AI 提示設計挑戰實驗室筆記

## 挑戰場景概述
你是一個教育內容新創公司的成員，與線上零售商 Cymbal Direct 合作，為其新的戶外裝備產品線創建生成式 AI 營銷工具。

## 任務分解

### 任務 1：建立 Gemini 圖像分析工具

#### 目標
創建一個模板來分析 Cymbal Direct 產品圖片，生成多樣化的描述性文字。

#### 具體要求
- **模型**：使用 `model_name` 模型
- **圖片位置**：Google Cloud Storage 中的指定路徑
- **生成內容類型**：
  1. 簡短的描述性文字
  2. 適合廣告的吸引人短語
  3. 以自然為重點的詩意描述

#### 提示設計策略
```python
# 多樣化描述生成提示
"""
分析這張產品圖片並生成多種描述：
1. 簡短描述（重點：產品特徵）
2. 廣告短語（重點：吸引力）
3. 詩意描述（重點：情感連結）
"""
```

#### 最佳實踐
- 實驗不同的提示措辭
- 調整參數以優化結果
- 保存提示名為 "Cymbal Product Analysis"

### 任務 2：建立 Gemini 標語生成器

#### 系統指令設置
```
Cymbal Direct 正在與戶外裝備零售商合作。他們推出新的產品線，
旨在鼓勵年輕人探索戶外。幫助他們為這個產品線創建吸引人的標語。
```

#### 範例設置
**範例 1：**
- 輸入：為徒步旅行者設計的耐用背包標語，讓他們感到準備充分。考慮簡約風格。
- 輸出：為旅程而生：你的冒險必需品。

**範例 2：**（需要自行添加）
- 輸入：[自定義]
- 輸出：[相應格式的標語]

#### 可自定義參數
- **產品屬性**：耐用、輕量、防水等
- **目標受眾**：年輕冒險家、家庭、學生等
- **情感共鳴**：賦權、連結、自由等

#### 提示設計要點
```python
# 標語生成提示結構
"""
基於以下參數生成標語：
產品屬性：{attributes}
目標受眾：{audience} 
情感共鳴：{emotion}
風格要求：{style}
"""
```

### 任務 3：實驗圖像分析程式碼

#### 程式碼探索步驟
1. 在 Vertex AI Studio 中導航到 "Cymbal Product Analysis" 提示
2. 點擊 "Code" 並選擇 Python
3. 複製第二個程式碼單元到 Jupyter notebook

#### 程式碼修改重點
**原始提示：**
```python
"""Describe this image with a focus on colors, textures, and the feeling it evokes."""
```

**修改要求 1：限制輸出長度**
```python
"""用少於10個字描述這張圖片。"""
```

**修改要求 2：增加創造性**
```python
"""用最具創意、不尋常和意想不到的方式描述這張圖片。"""
```

**參數調整提示：**
- 調整 `temperature` 參數來增加創造性
- 較高的 temperature 值（如 0.8-1.0）會產生更多樣化的輸出

#### 完整程式碼範例
```python
import google.generativeai as genai

# 配置客戶端
genai.configure(
    client_options=ClientOptions(
        api_endpoint=f"us-central1-aiplatform.googleapis.com"
    )
)

# 修改後的提示
prompt = """用少於10個字，以最具創意和意想不到的方式描述這張圖片。"""

# 生成內容
response = model.generate_content([
    prompt,
    uploaded_image
], generation_config=genai.types.GenerationConfig(
    temperature=0.9,  # 增加創造性
    max_output_tokens=50  # 限制輸出長度
))
```

### 任務 4：實驗標語生成程式碼

#### 程式碼修改重點
**原始輸入：**
```python
"Write a tagline for a waterproof jacket for families that makes them feel secure."
```

**修改要求：包含特定關鍵字**
```python
"Write a tagline for a waterproof jacket for families that makes them feel secure. Include the keyword 'nature'."
```

#### 驗證要點
- 確保生成的標語包含 "nature" 關鍵字
- 測試不同的產品組合以驗證模板的靈活性

## 技術實現要點

### 身份驗證處理
```python
# 在 notebook 中替換 API 金認證方式
# 原始（使用 API 金鑰）：
genai.configure(api_key="your-api-key")

# 替換為（使用專案憑證）：
from google.cloud import aiplatform
aiplatform.init(project=PROJECT_ID, location=LOCATION)
```

### 參數調優策略
- **Temperature**: 控制創造性（0.0-1.0）
- **Max Output Tokens**: 控制回應長度
- **Top-P/Top-K**: 控制輸出的多樣性

### 錯誤處理
```python
try:
    response = model.generate_content(prompt)
    if response.text:
        print("生成成功:", response.text)
    else:
        print("沒有生成內容")
        print("阻止原因:", response.prompt_feedback.block_reason)
except Exception as e:
    print("錯誤:", str(e))
```

## 評分關鍵點

### 任務完成標準
1. **正確的提示命名**：Cymbal Product Analysis / Cymbal Tagline Generator Template
2. **適當的模型選擇**：使用指定的 `model_name` 模型
3. **區域設置**：選擇正確的區域
4. **程式碼修改**：按要求修改提示內容和參數
5. **輸出驗證**：確保生成內容符合要求（長度、關鍵字等）

### 常見問題解決
- **429 錯誤**：請求過於頻繁，等待後重試
- **身份驗證失敗**：確保使用正確的專案 ID 和位置
- **內容被阻止**：調整安全設置或重新措辭提示

## 學習成果總結

通過這個挑戰實驗室，你應該掌握：

1. **提示設計技巧**：創建有效的多模態和文字生成提示
2. **參數調優**：使用適當的模型參數控制輸出質量
3. **程式碼整合**：將 Vertex AI Studio 的提示導出到 Python 程式碼
4. **迭代優化**：基於測試結果不斷改進提示設計
5. **實際應用**：將生成式 AI 應用於真實的營銷場景

這個實驗室強調了從 GUI 工具到程式碼實現的完整工作流程，為在實際專案中部署生成式 AI 解決方案奠定了基礎。